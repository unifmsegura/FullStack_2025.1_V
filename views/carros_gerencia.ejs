<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>Gerência de Carros</title>
  <link rel="stylesheet" href="/public/estilo.css" />
</head>
<body>
  <div class="container">
    <h1>Gerência de Carros</h1>
    <% if (msg) { %>
      <p><strong><%= msg %></strong></p>
    <% } %>

    <h2>Cadastrar Novo Carro</h2>
    <form action="/carros/cadastrar" method="post">
      <label>Marca</label><br/>
      <input type="text" name="marca" required /><br/>
      <label>Modelo</label><br/>
      <input type="text" name="modelo" required /><br/>
      <label>Ano</label><br/>
      <input type="number" name="ano" required /><br/>
      <label>Quantidade Disponível</label><br/>
      <input type="number" name="qtde_disponivel" value="1" min="0" required /><br/>
      <button type="submit">Cadastrar Carro</button>
    </form>

    <h2>Lista de Carros</h2>
    <table>
      <thead>
        <tr>
          <th>Marca</th>
          <th>Modelo</th>
          <th>Ano</th>
          <th>Qtde</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <% if (carros.length === 0) { %>
          <tr><td colspan="5">Nenhum carro cadastrado.</td></tr>
        <% } %>
        <% carros.forEach(function(c){ %>
          <tr>
            <td><%= c.marca %></td>
            <td><%= c.modelo %></td>
            <td><%= c.ano %></td>
            <td>
              <% if ((c.qtde_disponivel || 0) <= 0) { %>
                Esgotado
              <% } else { %>
                <%= c.qtde_disponivel %>
              <% } %>
            </td>
            <td>
              
              <form action="/carros/<%= c._id %>/vender" method="post" style="display:inline">
                <button type="submit">Vender</button>
              </form>

              
              <form action="/carros/<%= c._id %>/remover" method="post" style="display:inline">
                <button type="submit" class="secondary">Remover</button>
              </form>

              
              <details style="display:inline">
                <summary>Atualizar</summary>
                <form action="/carros/<%= c._id %>/atualizar" method="post" style="margin-top:8px">
                  <input type="text" name="marca" value="<%= c.marca %>" required placeholder="Marca" />
                  <input type="text" name="modelo" value="<%= c.modelo %>" required placeholder="Modelo" />
                  <input type="number" name="ano" value="<%= c.ano %>" required placeholder="Ano" />
                  <input type="number" name="qtde_disponivel" value="<%= c.qtde_disponivel %>" min="0" required placeholder="Quantidade" />
                  <button type="submit">Salvar</button>
                </form>
              </details>
            </td>
          </tr>
        <% }); %>
      </tbody>
    </table>

    <p><a href="/carros">Ver lista pública</a></p>
    <p><a href="/projects.html">Voltar para Projects</a></p>
  </div>
</body>
</html>